<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Asetukset - Taxa treenaus</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <main class="wrap">
    <header class="top">
      <h1>Asetukset</h1>
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn secondary" href="/settings/taxa">Taxa valinta</a>
        <a class="btn" href="/">Takaisin</a>
      </div>
    </header>

    <section class="card">
      {% if saved %}
        <div style="margin-bottom: 12px; opacity: 0.95;">✅ Tallennettu</div>
      {% endif %}

      <!-- Dataset selection (uses your existing GET endpoint) -->
      <div style="margin-bottom: 16px;">
        <div style="margin-top:0; opacity:0.9;
          margin-bottom:8px;">Harjoiteltavat lajit</div>

        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <select id="datasetSelect" class="inp" style="max-width: 320px;">
            {% for d in datasets %}
              <option value="{{ d }}" {% if d == selected_dataset %}selected{% endif %}>
                {{ d }}
              </option>
            {% endfor %}
          </select>

          <button class="btn secondary" type="button"
                  onclick="window.location.href='/settings/dataset?d=' + document.getElementById('datasetSelect').value;">
            Käytä
          </button>
        </div>
      </div>

      <!-- ONE POST form for everything else -->
      <form method="POST" action="/settings">
        <p style="margin-top:0; opacity:0.9;">Valitse mitä harjoitellaan.</p>

        <!-- Rank toggles -->
        <div style="margin: 12px 0 16px 0;">
          <div style="margin-bottom:8px; opacity:0.9;">Näytettävät taksonomiset tasot</div>

          <div style="display:grid; gap:10px;">
            <label style="display:flex; gap:10px; align-items:center;">
              <input type="checkbox" name="ranks" value="phylum" {% if "phylum" in enabled %}checked{% endif %} />
              <span>{{ rank_fi.get("phylum","phylum") }} <span style="opacity:0.7;">(phylum)</span></span>
            </label>

            <label style="display:flex; gap:10px; align-items:center;">
              <input type="checkbox" name="ranks" value="class" {% if "class" in enabled %}checked{% endif %} />
              <span>{{ rank_fi.get("class","class") }} <span style="opacity:0.7;">(class)</span></span>
            </label>

            <label style="display:flex; gap:10px; align-items:center;">
              <input type="checkbox" name="ranks" value="order" {% if "order" in enabled %}checked{% endif %} />
              <span>{{ rank_fi.get("order","order") }} <span style="opacity:0.7;">(order)</span></span>
            </label>

            <label style="display:flex; gap:10px; align-items:center;">
              <input type="checkbox" name="ranks" value="family" {% if "family" in enabled %}checked{% endif %} />
              <span>{{ rank_fi.get("family","family") }} <span style="opacity:0.7;">(family)</span></span>
            </label>

            {# Combined checkbox #}
            <label style="display:flex; gap:10px; align-items:center;">
              <input type="checkbox" name="ranks_genus_species" value="1"
                    {% if "genus" in enabled or "species" in enabled %}checked{% endif %} />
              <span>Suku + laji <span style="opacity:0.7;">(genus + species)</span></span>
            </label>

          </div>
        </div>

        <hr style="border:0; border-top:1px solid #243244; margin:16px 0;" />

        <div style="margin: 12px 0 16px 0;">
          <div style="margin-bottom:8px; opacity:0.9;">Toimintonapit</div>

          <label style="display:flex; gap:10px; align-items:center;">
            <input type="radio" name="actions_position" value="top"
                  {% if actions_position != "bottom" %}checked{% endif %} />
            <span>Napit kortin yläpuolella</span>
          </label>

          <label style="display:flex; gap:10px; align-items:center; margin-top:8px;">
            <input type="radio" name="actions_position" value="bottom"
                  {% if actions_position == "bottom" %}checked{% endif %} />
            <span>Napit ruudun alareunassa (mobiili)</span>
          </label>
        </div>

        <hr style="border:0; border-top:1px solid #243244; margin:16px 0;" />

        <hr style="border:0; border-top:1px solid #243244; margin:16px 0;" />

        <div style="margin: 12px 0 16px 0;">
          <div style="margin-bottom:8px; opacity:0.9;">Vihje kortin yläosassa</div>

          <label style="display:flex; gap:10px; align-items:center;">
            <input type="radio" name="hint_language" value="fin"
                  {% if hint_language != "lat" %}checked{% endif %}>
            <span>Suomenkielinen nimi</span>
          </label>

          <label style="display:flex; gap:10px; align-items:center; margin-top:8px;">
            <input type="radio" name="hint_language" value="lat"
                  {% if hint_language == "lat" %}checked{% endif %}>
            <span>Latinalainen nimi</span>
          </label>
        </div>
        <div style="margin-top:16px;">
          <button class="btn" type="submit">Tallenna</button>
        </div>
      </form>
        <div style="margin-top:16px;">
        </div>
    </section>
  </main>
</body>
</html>

